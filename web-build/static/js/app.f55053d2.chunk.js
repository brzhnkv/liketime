(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{326:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n(28),r=n.n(a),o=n(5),c=n.n(o),s=n(6),l=n.n(s),i=n(0),u=n.n(i),f=n(291),m=n(684),p=n(4),g=n(26),d=n(3),b=n(51),h=n(57),v=n(123),y=n(36);function x(e){var t=e.stompClient,n=e.loggedInUsername,a=e.token,r=e.logFromServer,o=e.statusMessage,c=Object(i.useState)(""),s=l()(c,2),f=s[0],m=s[1],p=Object(i.useState)(""),h=l()(p,2),v=h[0],x=h[1],S=Object(i.useState)(""),O=l()(S,2),w=O[0],k=O[1],P=Object(i.useState)(""),j=l()(P,2),I=j[0],C=j[1],J=Object(i.useState)(""),N=l()(J,2);N[0],N[1];return u.a.createElement(d.a,null,u.a.createElement(g.a,{accessibilityRole:"header"},"\u041b\u0430\u0439\u043a"),u.a.createElement(y.a,{style:E.textInput,textAlign:"center",value:f,placeholder:"\u0422\u0435\u0433",onChangeText:function(e){return m(e)}}),u.a.createElement(b.a,{title:"\u0421\u0442\u0430\u0440\u0442",onPress:function(){if(""!==f){var e={username:n,token:a,tag:f};t.connected?t.publish({destination:"/app/like",body:JSON.stringify(e)}):alert("stomp not ready")}else alert("\u0422\u0435\u0433 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!")}}),u.a.createElement(g.a,{accessibilityRole:"header"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435"),u.a.createElement(y.a,{style:E.textInput,textAlign:"center",value:v,placeholder:"\u0422\u0435\u0433",onChangeText:function(e){return x(e)}}),u.a.createElement(b.a,{title:"\u0421\u0442\u0430\u0440\u0442",onPress:function(){if(""!==v){var e={username:n,token:a,tag:v};t.connected?t.publish({destination:"/app/save",body:JSON.stringify(e)}):alert("stomp not ready")}else alert("\u0422\u0435\u0433 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!")}}),u.a.createElement(g.a,{accessibilityRole:"header"},"\u041b\u0430\u0439\u043a + \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435"),u.a.createElement(y.a,{style:E.textInput,textAlign:"center",value:w,placeholder:"\u0422\u0435\u0433",onChangeText:function(e){return k(e)}}),u.a.createElement(b.a,{title:"\u0421\u0442\u0430\u0440\u0442",onPress:function(){if(""!==w){var e={username:n,token:a,tag:w};t.connected?t.publish({destination:"/app/likeandsave",body:JSON.stringify(e)}):alert("stomp not ready")}else alert("\u0422\u0435\u0433 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!")}}),u.a.createElement(g.a,{accessibilityRole:"header"},"\u0421\u0430\u043c\u043e\u043b\u0435\u0442"),u.a.createElement(y.a,{style:E.textInput,textAlign:"center",value:I,placeholder:"\u0422\u0435\u0433",onChangeText:function(e){return C(e)}}),u.a.createElement(b.a,{title:"\u0421\u0442\u0430\u0440\u0442",onPress:function(){if(""!==I){var e={username:n,token:a,tag:I};t.connected?t.publish({destination:"/app/sendmediatogroup",body:JSON.stringify(e)}):alert("stomp not ready")}else alert("\u0422\u0435\u0433 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!")}}),u.a.createElement(g.a,null,"Log from server: ",r),u.a.createElement(g.a,null,"Status: ",o))}var E=p.a.create({textInput:{height:40,borderColor:"gray",borderWidth:1,width:"100%",marginVertical:10}}),S=n(682),O=n(683),w=n(44),k=(n(172),"#E8CEBF"),P="#fff",j=p.a.create({root:{flex:1,backgroundColor:k},container:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:k},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60}}),I=function(e){var t=e.userProfilePic,n=e.token,a=e.loggedInUsername,r=e.isLoggedIn,o=e.isConnected,s=e.stompClient,f=e.logFromServer,m=e.statusMessage,p=Object(i.useState)(""),y=l()(p,2),E=(y[0],y[1],Object(i.useState)("log")),I=l()(E,2),C=(I[0],I[1],Object(i.useState)("not connected")),J=l()(C,2),N=(J[0],J[1],Object(i.useState)(!0)),L=l()(N,2);L[0],L[1];Object(i.useEffect)((function(){return R(),function(){}}),[]);var T=function(e){var t,n;return c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.awrap(w.a.getItem(e));case 3:t=a.sent,n=JSON.parse(t),setToken(n.token),setLoggedInUsername(e),setUserProfilePic(n.profilePic),a.next=12;break;case 10:a.prev=10,a.t0=a.catch(0);case 12:case"end":return a.stop()}}),null,null,[[0,10]],Promise)},R=function(){var e;return c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.awrap(w.a.getItem("@logged_in_user"));case 3:e=t.sent,setIsLoggedIn(!0),T(e),t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),null,null,[[0,8]],Promise)},U=Object(i.useState)(""),F=l()(U,2),_=(F[0],F[1],Object(i.useState)("")),A=l()(_,2),M=(A[0],A[1],Object(i.useState)("")),D=l()(M,2),W=(D[0],D[1],Object(i.useState)("")),z=l()(W,2);z[0],z[1];return u.a.createElement(d.a,{style:j.root},u.a.createElement(v.a,{backgroundColor:k,barStyle:"default"}),u.a.createElement(d.a,{style:j.header},u.a.createElement(d.a,{style:j.toolbar},u.a.createElement(S.a,{name:"text",size:30,style:{color:P}}),u.a.createElement(g.a,null,"LikeTime"),u.a.createElement(d.a,{style:{flexDirection:"row"}},u.a.createElement(O.a,{name:"user",size:30,style:{color:P}}))),u.a.createElement(d.a,null,u.a.createElement(g.a,null,"Text"))),u.a.createElement(d.a,{style:j.container},u.a.createElement(g.a,null,"StompJS connected: ",JSON.stringify(o)),u.a.createElement(b.a,{title:"LOGOUT FROM ALL (deletes all cookies)",onPress:function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.a.awrap(w.a.removeItem("@logged_in_user"));case 3:return e.next=5,c.a.awrap(w.a.clear());case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:console.log("Done.");case 10:case"end":return e.stop()}}),null,null,[[0,7]],Promise)}}),u.a.createElement(g.a,null,"isLoggedIn: ",JSON.stringify(r)),u.a.createElement(g.a,null,"loggedInUsername: ",a),u.a.createElement(g.a,null,"token: ",n),u.a.createElement(h.a,{style:j.logo,source:t?{uri:t}:null}),s.connected&&u.a.createElement(x,{stompClient:s,loggedInUsername:a,token:n,logFromServer:f,statusMessage:m})))},C=(p.a.create({}),function(e){var t=e.navigation,n=e.stompClient,a=Object(i.useState)(""),r=l()(a,2),o=r[0],s=r[1],f=Object(i.useState)(""),m=l()(f,2),p=m[0],h=m[1],v=function(e,t){var a;return c.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:a={username:e,password:t},n.connected?n.publish({destination:"/app/auth/login",body:JSON.stringify(a)}):alert("stomp not ready"),n&&console.log("works");case 3:case"end":return r.stop()}}),null,null,null,Promise)};return u.a.createElement(d.a,{style:J.container},u.a.createElement(g.a,{style:J.titleText},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),u.a.createElement(y.a,{style:J.textInput,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",value:o,onChangeText:function(e){s(e)}}),u.a.createElement(y.a,{style:J.textInput,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",secureTextEntry:!0,value:p,onChangeText:function(e){h(e)}}),u.a.createElement(b.a,{title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){v(o,p),t.navigate("Home")}}))}),J=p.a.create({container:{flex:1,alignItems:"center"},titleText:{fontSize:30,fontWeight:"bold"},textInput:{margin:20,height:40,borderColor:"red",borderWidth:1,width:"80%"}}),N=n(74),L=function(e){var t=e.username,n=e.userProfilePic;return u.a.createElement(d.a,null,u.a.createElement(N.a,{style:T.root},u.a.createElement(h.a,{style:T.logo,source:{uri:n}}),u.a.createElement(g.a,{style:T.text},t)))},T=p.a.create({root:{flex:1,flexDirection:"row",justifyContent:"flex-end",alignItems:"center",height:50,marginRight:5},logo:{width:45,height:45,marginRight:5},text:{fontSize:14,fontWeight:"500",color:"#94d82d"}}),R=n(327),U=n(685),F=(n(64),Object(m.a)());function _(){var e=Object(i.useState)(!1),t=l()(e,2),n=t[0],a=t[1],o=Object(i.useState)(!1),s=l()(o,2),m=s[0],p=s[1],g=Object(i.useState)(""),d=l()(g,2),b=d[0],h=d[1],v=Object(i.useState)(""),y=l()(v,2),x=y[0],E=y[1],S=Object(i.useState)(""),O=l()(S,2),k=O[0],P=O[1],j=Object(i.useState)(""),J=l()(j,2),N=J[0],T=J[1],_=Object(i.useState)(""),A=l()(_,2),M=A[0],D=A[1],W=Object(i.useState)(""),z=l()(W,2),H=z[0],B=z[1],G=function(){var e;return c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.awrap(w.a.getItem("@logged_in_user"));case 3:null==(e=t.sent)?h("Login"):(p(!0),K(e),h("Home")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),alert("error");case 10:case"end":return t.stop()}}),null,null,[[0,7]],Promise)},K=function(e){var t,n;return c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.awrap(w.a.getItem(e));case 3:t=a.sent,n=JSON.parse(t),T(n.token),E(e),P(n.profilePic),a.next=12;break;case 10:a.prev=10,a.t0=a.catch(0);case 12:case"end":return a.stop()}}),null,null,[[0,10]],Promise)};Object(i.useEffect)((function(){return function(){var e;c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],t.prev=1,t.next=4,c.a.awrap(w.a.getAllKeys());case 4:e=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:console.log(e);case 10:case"end":return t.stop()}}),null,null,[[1,7]],Promise)}(),function(){}}),[]);var V=function(e){var t,n;return c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.awrap(w.a.getItem(e));case 3:null!==(t=a.sent)&&(n=JSON.parse(t),console.log("data from getData: "+n),T(n.token),P(n.userProfilePic),console.log("token: "+N),console.log("upp: "+k)),a.next=9;break;case 7:a.prev=7,a.t0=a.catch(0);case 9:case"end":return a.stop()}}),null,null,[[0,7]],Promise)},q=Object(i.useState)(!1),Q=l()(q,2),X=Q[0],Y=Q[1],Z=Object(i.useState)(new U.a),$=l()(Z,2),ee=$[0],te=($[1],{brokerURL:"wss://instanext-server.herokuapp.com/ws",appendMissingNULLonIncoming:!0,forceBinaryWSFrames:!0,debug:function(e){console.log("STOMP: "+e)},reconnectDelay:1e4});Object(i.useEffect)((function(){ee.configure(te),ee.activate(),ee.watch("/user/notification/login").subscribe((function(e){var t=JSON.parse(e.body);if(console.log(t),null!==t.data.token){var n=t.data.username,a={token:t.data.token,profilePic:t.data.userProfilePic};!function(e){c.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.awrap(w.a.setItem("@logged_in_user",e));case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:G();case 8:case"end":return t.stop()}}),null,null,[[0,5]],Promise)}(n),function(e,t){var n;c.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n=JSON.stringify(t),a.next=4,c.a.awrap(w.a.setItem(e,n));case 4:a.next=8;break;case 6:a.prev=6,a.t0=a.catch(0);case 8:V(e),console.log("key: "+e);case 10:case"end":return a.stop()}}),null,null,[[0,6]],Promise)}(n,a)}})),ee.watch("/user/notification/status").subscribe((function(e){var t=JSON.parse(e.body);B(t.status)})),ee.watch("/user/notification/log").subscribe((function(e){var t=JSON.parse(e.body);D(t.status)})),Y(!0)}),[]);return n?u.a.createElement(f.a,null,u.a.createElement(F.Navigator,{initialRouteName:b},u.a.createElement(F.Screen,{name:"Home",options:{headerLeft:null,headerRight:function(e){return u.a.createElement(L,{username:x,userProfilePic:k})}}},(function(e){return u.a.createElement(I,r()({},e,{isLoggedIn:m,loggedInUsername:x,userProfilePic:k,token:N,isConnected:X,stompClient:ee,logFromServer:M,statusMessage:H}))})),u.a.createElement(F.Screen,{name:"Login"},(function(e){return u.a.createElement(C,r()({},e,{isConnected:X,stompClient:ee}))})))):u.a.createElement(R.a,{startAsync:function(){return c.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G());case 1:case"end":return e.stop()}}),null,null,null,Promise)},onFinish:function(){return a(!0)},onError:function(){}})}},337:function(e,t,n){e.exports=n(674)}},[[337,1,2]]]);
//# sourceMappingURL=app.f55053d2.chunk.js.map