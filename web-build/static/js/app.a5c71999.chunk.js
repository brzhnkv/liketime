(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{362:function(e,t,n){"use strict";n.d(t,"a",(function(){return re}));var a=n(17),r=n.n(a),o=n(9),s=n.n(o),c=n(14),i=n.n(c),u=n(0),l=n.n(u),f=n(336),p=n(717),m=n(2),g=n(21),b=n(4),x=n(58),h=l.a.createContext(null),v=l.a.createContext(null);m.a.create({});var y=n(34),w=n(65),E=(n(62),n(69),n(200),n(718)),C=n(23),O=n.n(C),j=n(92),k=n(205);function S(e){var t=e.visible,n=e.setVisible,a=Object(u.useContext)(h),r=s()(a,1)[0],o=Object(u.useContext)(v),c=s()(o,2),f=c[0],p=c[1],m=Object(u.useState)(""),g=s()(m,2),d=g[0],b=g[1],x=Object(u.useState)(""),w=s()(x,2),E=w[0],C=w[1],k=Object(u.useState)(!1),S=s()(k,2),P=S[0],N=S[1];Object(u.useEffect)((function(){P&&(r.watch("/user/"+f[0].username+"/queue/login/addaccount").subscribe((function(e){var t=JSON.parse(e.body);if(console.log(t),null!==t.data.token){var n=t.data.username,a=t.data.token;!function(e){var t,n,a;i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return(t=O()(f)).push(e),n=t.findIndex((function(t){return t.username===e.username})),t.unshift(t.splice(n,1)[0]),r.prev=4,r.next=7,i.a.awrap(y.a.setItem("users",JSON.stringify(t)));case 7:r.next=12;break;case 9:r.prev=9,r.t0=r.catch(4),alert("error1");case 12:return r.prev=12,r.t1=JSON,r.next=16,i.a.awrap(y.a.getItem("users"));case 16:r.t2=r.sent,a=r.t1.parse.call(r.t1,r.t2),p(a),r.next=24;break;case 21:r.prev=21,r.t3=r.catch(12),alert("error2");case 24:case"end":return r.stop()}}),null,null,[[4,9],[12,21]],Promise)}({username:n,profilePic:t.data.userProfilePic,token:a})}})),T(d,E))}),[P]);var J=function(){n(!1)},T=function(e,t){var n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:n={username:e,password:t},r.publish({destination:"/app/auth/addaccount",body:JSON.stringify(n)});case 2:case"end":return a.stop()}}),null,null,null,Promise)};return l.a.createElement(j.a.Container,{visible:t,onBackdropPress:J},l.a.createElement(j.a.Title,null,"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"),l.a.createElement(j.a.Input,{style:I.input,autoCapitalize:"none",label:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",autoCorrect:!1,value:d,onChangeText:function(e){b(e)}}),l.a.createElement(j.a.Input,{style:I.input,wrapperStyle:I.wrapper,autoCapitalize:"none",autoCorrect:!1,label:"\u041f\u0430\u0440\u043e\u043b\u044c:",value:E,onChangeText:function(e){C(e)}}),l.a.createElement(j.a.Button,{label:"\u041e\u0442\u043c\u0435\u043d\u0430",onPress:J}),l.a.createElement(j.a.Button,{label:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){N(!0)}}))}var I=m.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"},input:{borderBottomColor:"black",borderBottomWidth:.8},wrapper:{}}),P=l.a.createContext(null),N="#E8CEBF",J=(Object(E.a)(),m.a.create({root:{flex:1,backgroundColor:N},container:{flex:1,marginTop:10,alignItems:"center",justifyContent:"flex-start"},dialog:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:N},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60}}),n(49)),T=m.a.create({root:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},textInput:{height:40,borderBottomColor:"gray",borderBottomWidth:1,width:"80%",marginVertical:10}}),M=function(e){var t=e.taskName,n=e.destination,a=e.buttonName,r=Object(u.useContext)(h),o=s()(r,1)[0],c=Object(u.useContext)(v),f=s()(c,1)[0],p=Object(u.useState)(""),m=s()(p,2),g=m[0],d=m[1];return l.a.createElement(b.a,{style:T.root},l.a.createElement(k.a,{style:T.textInput,autoCapitalize:"none",autoCorrect:!1,textAlign:"center",value:g,placeholder:t,onChangeText:function(e){return d(e)}}),l.a.createElement(J.a,{title:a||"\u0421\u0442\u0430\u0440\u0442",onPress:function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:""!==g?(e={username:f[0].username,token:f[0].token,tag:g},o.publish({destination:n,body:JSON.stringify(e)})):alert("\u0422\u0435\u0433 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c!");case 1:case"end":return t.stop()}}),null,null,null,Promise)}}))},B=m.a.create({root:{flex:1,marginTop:10,alignItems:"center",justifyContent:"flex-start"},logsView:{alignSelf:"flex-start",justifyContent:"flex-start",alignItems:"flex-start",paddingHorizontal:10},dialog:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:"#E8CEBF"},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60},inputWrapper:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},textInput:{height:40,borderBottomColor:"gray",borderBottomWidth:1,width:"80%",marginVertical:10}}),L=function(e){var t=e.logFromServer,n=e.statusMessage;return l.a.createElement(b.a,{style:B.root},l.a.createElement(M,{taskName:"\u041b\u0430\u0439\u043a",destination:"/app/like"}),l.a.createElement(M,{taskName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",destination:"/app/save"}),l.a.createElement(M,{taskName:"\u041b\u0430\u0439\u043a + \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",destination:"/app/likeandsave"}),l.a.createElement(M,{taskName:"\u0421\u0430\u043c\u043e\u043b\u0435\u0442",destination:"/app/sendmediatogroup"}),l.a.createElement(b.a,{style:B.logsView},l.a.createElement(g.a,null,"\u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435: ",t),l.a.createElement(g.a,null,"\u0421\u0442\u0430\u0442\u0443\u0441: ",n)))},F="#E8CEBF",W=m.a.create({root:{flex:1,backgroundColor:F},container:{flex:1,marginTop:10,alignItems:"center",justifyContent:"flex-start"},dialog:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:F},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60}}),D=function(e){var t=e.logFromServer,n=e.statusMessage,a=Object(u.useContext)(h),r=s()(a,1)[0],o=Object(u.useContext)(v),c=s()(o,1)[0];return l.a.createElement(b.a,{style:W.container},l.a.createElement(J.a,{title:"test",onPress:function(){r.publish({destination:"/app/test"})}}),l.a.createElement(J.a,{title:"1212",onPress:function(){var e={username:c[0].username,token:c[0].token,tag:"onedayinperu"};r.publish({destination:"/app/newlike",body:JSON.stringify(e)})}}),l.a.createElement(g.a,null,"Log from server: ",t),l.a.createElement(g.a,null,"Status: ",n))},R="#E8CEBF",_=m.a.create({root:{flex:1,backgroundColor:R},container:{flex:1,marginTop:10,alignItems:"center",justifyContent:"flex-start"},dialog:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:R},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60}}),U=function(e){var t=e.logFromServer,n=e.statusMessage,a=Object(u.useContext)(h),r=s()(a,1)[0],o=Object(u.useContext)(v),c=s()(o,1)[0];return l.a.createElement(b.a,{style:_.container},l.a.createElement(J.a,{title:"1212",onPress:function(){var e={username:c[0].username,token:c[0].token,tag:"onedayinperu"};r.publish({destination:"/app/newlike",body:JSON.stringify(e)})}}),l.a.createElement(g.a,null,"Log from server: ",t),l.a.createElement(g.a,null,"Status: ",n))},V="#E8CEBF",z="#fff",H=Object(E.a)(),q=function(e){e.navigation;var t=Object(u.useContext)(h),n=s()(t,3),a=n[0],o=n[1],c=n[2],i=Object(u.useContext)(v),f=s()(i,2),p=f[0],m=(f[1],Object(u.useContext)(P)),d=s()(m,2),y=d[0],E=d[1],C=Object(u.useState)(""),O=s()(C,2),j=O[0],k=O[1],I=Object(u.useState)(""),N=s()(I,2),J=N[0],T=N[1],M={brokerURL:"wss://instanext-server.herokuapp.com/ws",connectHeaders:{sessionId:p[0].username,token:p[0].token},appendMissingNULLonIncoming:!0,forceBinaryWSFrames:!0,debug:function(e){console.log("STOMP: "+e)},reconnectDelay:1e4};a.configure(M);var B,F,W=Object(u.useState)(),R=s()(W,2),_=R[0],V=R[1];return Object(u.useEffect)((function(){var e=a.connectionState$.subscribe(V);return console.log(_===w.a.OPEN),c(_===w.a.OPEN),function(){return e.unsubscribe()}})),Object(u.useEffect)((function(){return k(""),T(""),a.activate(),B=a.watch("/user/"+p[0].username+"/queue/status").subscribe((function(e){var t=JSON.parse(e.body);T(t.status)})),F=a.watch("/user/"+p[0].username+"/queue/log").subscribe((function(e){var t=JSON.parse(e.body);k(t.status)})),function(){B.unsubscribe(),F.unsubscribe()}}),[p]),l.a.createElement(b.a,{style:A.root},l.a.createElement(x.a,{backgroundColor:z,barStyle:"dark-content"}),l.a.createElement(S,{visible:y,setVisible:E,style:A.dialog}),o?l.a.createElement(H.Navigator,null,l.a.createElement(H.Screen,{name:"\u041b\u0430\u0439\u043a\u0438"},(function(e){return l.a.createElement(L,r()({},e,{isConnected:o,logFromServer:j,statusMessage:J,visible:y,setVisible:E}))})),l.a.createElement(H.Screen,{name:"\u041f\u043e\u0434\u043f\u0438\u0441\u043a\u0438"},(function(e){return l.a.createElement(U,r()({},e,{logFromServer:j,statusMessage:J}))})),l.a.createElement(H.Screen,{name:"Extra"},(function(e){return l.a.createElement(D,r()({},e,{logFromServer:j,statusMessage:J}))}))):l.a.createElement(g.a,null,"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e..."))},A=m.a.create({root:{flex:1,backgroundColor:V},container:{flex:1,marginTop:10,alignItems:"center",justifyContent:"flex-start"},dialog:{flex:1,alignItems:"center",justifyContent:"center"},header:{backgroundColor:V},toolbar:{padding:16,flexDirection:"row",justifyContent:"space-between"},textInput:{height:40,borderColor:"gray",borderWidth:1,width:"50%"},logo:{width:60,height:60}}),$=n(33),G=function(e){var t=e.navigation,n=Object(u.useContext)(h),a=s()(n,1)[0],r=Object(u.useContext)(v),o=s()(r,2),c=o[0],f=o[1],p=Object(u.useState)(""),m=s()(p,2),d=m[0],x=m[1],w=Object(u.useState)(""),E=s()(w,2),C=E[0],O=E[1];Object(u.useEffect)((function(){return c.length&&t.navigate("Home"),function(){j.unsubscribe()}}),[c]);var j;Object(u.useEffect)((function(){var e={brokerURL:"wss://instanext-server.herokuapp.com/ws",connectHeaders:{sessionId:"guest",token:null},appendMissingNULLonIncoming:!0,forceBinaryWSFrames:!0,debug:function(e){console.log("STOMP: "+e)},reconnectDelay:1e4};return a.configure(e),j=a.watch("/user/guest/queue/login").subscribe((function(e){var t=JSON.parse(e.body);if(console.log(t),null!==t.data.token){var n=t.data.username,a=t.data.token;!function(e){var t,n;i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return(t=[]).push(e),a.prev=2,a.next=5,i.a.awrap(y.a.setItem("users",JSON.stringify(t)));case 5:a.next=9;break;case 7:a.prev=7,a.t0=a.catch(2);case 9:return a.prev=9,a.t1=JSON,a.next=13,i.a.awrap(y.a.getItem("users"));case 13:a.t2=a.sent,n=a.t1.parse.call(a.t1,a.t2),f(n),a.next=20;break;case 18:a.prev=18,a.t3=a.catch(9);case 20:case"end":return a.stop()}}),null,null,[[2,7],[9,18]],Promise)}({username:n,profilePic:t.data.userProfilePic,token:a})}})),a.activate(),function(){}}),[]);var k=function(e,t){var n;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:n={username:e,password:t},a.publish({destination:"/app/auth/login",body:JSON.stringify(n)});case 2:case"end":return r.stop()}}),null,null,null,Promise)};return l.a.createElement(b.a,{style:K.container},l.a.createElement(g.a,{style:K.titleText},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),l.a.createElement($.a,{style:K.textInput,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",value:d,onChangeText:function(e){x(e)}}),l.a.createElement($.a,{style:K.textInput,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",secureTextEntry:!0,value:C,onChangeText:function(e){O(e)}}),l.a.createElement(J.a,{title:"\u0412\u043e\u0439\u0442\u0438",onPress:function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.awrap(k(d,C));case 2:case"end":return e.stop()}}),null,null,null,Promise)}}))},K=m.a.create({container:{flex:1,alignItems:"center"},titleText:{fontSize:30,fontWeight:"bold"},textInput:{margin:20,height:40,borderColor:"red",borderWidth:1,width:"80%"}}),Q=n(44),X=n(72),Y=X.renderers.Popover,Z=function(){var e=Object(u.useContext)(h),t=s()(e,1)[0],n=Object(u.useContext)(v),a=s()(n,2),r=a[0],o=a[1],c=Object(u.useContext)(P),f=s()(c,2),p=(f[0],f[1]),m=function(e){var t,n,a;return i.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=O()(r),n=t.findIndex((function(t){return t.username===e})),t.unshift(t.splice(n,1)[0]),s.prev=3,s.next=6,i.a.awrap(y.a.setItem("users",JSON.stringify(t)));case 6:s.next=10;break;case 8:s.prev=8,s.t0=s.catch(3);case 10:return s.prev=10,s.t1=JSON,s.next=14,i.a.awrap(y.a.getItem("users"));case 14:s.t2=s.sent,a=s.t1.parse.call(s.t1,s.t2),o(a),s.next=21;break;case 19:s.prev=19,s.t3=s.catch(10);case 21:case"end":return s.stop()}}),null,null,[[3,8],[10,19]],Promise)};return l.a.createElement(X.Menu,{renderer:Y,rendererProps:{preferredPlacement:"bottom"}},l.a.createElement(X.MenuTrigger,{style:ee.menuTrigger},l.a.createElement(Q.a,{style:ee.logo,source:{uri:r[0].profilePic}}),l.a.createElement(g.a,{style:ee.text},r[0].username)),l.a.createElement(X.MenuOptions,{style:ee.menuOptions},r.slice(1).map((function(e,n){return l.a.createElement(X.MenuOption,{key:n,style:ee.menuOption,value:e.username,onSelect:function(e){return function(e){return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(t.deactivate());case 2:return n.next=4,i.a.awrap(m(e));case 4:return n.next=6,i.a.awrap(t.activate());case 6:case"end":return n.stop()}}),null,null,null,Promise)}(e)}},l.a.createElement(Q.a,{style:ee.logo,source:e.profilePic?{uri:e.profilePic}:null}),l.a.createElement(g.a,{style:ee.text},e.username))})),l.a.createElement(X.MenuOption,{disabled:!0}),l.a.createElement(X.MenuOption,{onSelect:function(){p(!0)},text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"})))},ee=m.a.create({logo:{width:45,height:45,marginRight:5,borderRadius:50},text:{fontSize:14,fontWeight:"500",color:"#94d82d"},menuTrigger:{flexDirection:"row",alignItems:"center",height:50,marginRight:5},menuOptions:{display:"flex"},menuOption:{flex:1,flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:50,marginRight:5}}),te=n(363),ne=n(719),ae=Object(p.a)();function re(){var e=Object(u.useState)(new ne.a),t=s()(e,2),n=t[0],a=(t[1],Object(u.useState)(!1)),o=s()(a,2),c=o[0],p=o[1],m=Object(u.useState)(!1),g=s()(m,2),b=g[0],x=g[1],w=Object(u.useState)(!1),E=s()(w,2),C=E[0],O=E[1],j=Object(u.useState)(""),k=s()(j,2),S=k[0],I=k[1],N=Object(u.useState)(""),J=s()(N,2),T=J[0],M=J[1],B=Object(u.useState)(""),L=s()(B,2),F=L[0],W=L[1],D=Object(u.useState)(""),R=s()(D,2),_=R[0],U=R[1],V=Object(u.useState)([]),z=s()(V,2),H=z[0],A=z[1],$=Object(u.useState)(!1),K=s()($,2),Q=K[0],Y=K[1],ee=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.awrap(y.a.getItem("@logged_in_user"));case 3:null==(e=t.sent)?I("Login"):(O(!0),re(e),{username:"kflkl",profilePic:"dffd"},I("Home")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),alert("error getting logged in user");case 10:case"end":return t.stop()}}),null,null,[[0,7]],Promise)},re=function(e){var t,n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.a.awrap(y.a.getItem(e));case 3:t=a.sent,n=JSON.parse(t),U(n.token),M(e),W(n.profilePic),a.next=12;break;case 10:a.prev=10,a.t0=a.catch(0);case 12:case"end":return a.stop()}}),null,null,[[0,10]],Promise)},oe=function(e,t){var n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n=JSON.stringify(t),a.next=4,i.a.awrap(y.a.setItem(e,n));case 4:a.next=8;break;case 6:a.prev=6,a.t0=a.catch(0);case 8:se(e);case 9:case"end":return a.stop()}}),null,null,[[0,6]],Promise)},se=function(e){return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.awrap(y.a.setItem("@logged_in_user",e));case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:return t.next=9,i.a.awrap(ee());case 9:case"end":return t.stop()}}),null,null,[[0,5]],Promise)},ce=function(e,t){var n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n=JSON.stringify(t),a.next=4,i.a.awrap(y.a.setItem(e,n));case 4:a.next=8;break;case 6:a.prev=6,a.t0=a.catch(0);case 8:return a.prev=8,a.next=11,i.a.awrap(y.a.setItem("@logged_in_user",e));case 11:a.next=15;break;case 13:a.prev=13,a.t1=a.catch(8);case 15:return a.prev=15,a.next=18,i.a.awrap(y.a.getItem("@logged_in_user"));case 18:d=a.sent,a.next=23;break;case 21:a.prev=21,a.t2=a.catch(15);case 23:return a.next=25,i.a.awrap(M(d));case 25:return a.next=27,i.a.awrap(re(d));case 27:case"end":return a.stop()}}),null,null,[[0,6],[8,13],[15,21]],Promise)},ie=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=JSON,t.next=4,i.a.awrap(y.a.getItem("users"));case 4:t.t1=t.sent,(e=t.t0.parse.call(t.t0,t.t1)).length?(O(!0),A(e),I("Home")):I("Login"),t.next=12;break;case 9:t.prev=9,t.t2=t.catch(0),I("Login");case 12:case"end":return t.stop()}}),null,null,[[0,9]],Promise)};Object(u.useEffect)((function(){null!==H&&H.map((function(e){console.log("users: ",e.username)}))}),[H]);return b?l.a.createElement(X.MenuProvider,null,l.a.createElement(h.Provider,{value:[n,c,p]},l.a.createElement(v.Provider,{value:[H,A]},l.a.createElement(P.Provider,{value:[Q,Y]},l.a.createElement(f.a,null,l.a.createElement(ae.Navigator,{initialRouteName:S},l.a.createElement(ae.Screen,{name:"LikeTime",options:{headerLeft:null,headerRight:function(e){return l.a.createElement(Z,null)}}},(function(e){return l.a.createElement(q,r()({},e,{isLoggedIn:C,loggedInUsername:T,userProfilePic:F,token:_,storeNewUser:ce,storeUser:oe}))})),l.a.createElement(ae.Screen,{name:"Login"},(function(e){return l.a.createElement(G,e)})))))))):l.a.createElement(te.a,{startAsync:function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie());case 1:case"end":return e.stop()}}),null,null,null,Promise)},onFinish:function(){x(!0)},onError:function(){}})}},370:function(e,t,n){e.exports=n(711)}},[[370,1,2]]]);
//# sourceMappingURL=app.a5c71999.chunk.js.map